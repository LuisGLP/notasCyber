 ## ¿Qué es tcpdump?

**Tcpdump** es un analizador de protocolos de red con línea de comandos. Una **interfaz de línea de comandos (CLI)** es una interfaz de usuario basada en texto que utiliza comandos para interactuar con la computadora. 

Se utiliza para capturar el tráfico de red, que puede guardarse en un **pcap**, es decir, un archivo que contiene paquetes de datos interceptados desde una interfaz o red. Al archivo pcap se puede acceder, o también puede ser analizado o compartido en otra ocasión. Los analistas utilizan tcpdump por una variedad de razones, desde la resolución de problemas de red hasta la identificación de actividades maliciosas. Tcpdump viene preinstalado en muchas distribuciones de Linux y también se puede instalar en otros sistemas operativos basados en Unix, como macOS®. 

**Nota**: Es habitual que el tráfico de red esté cifrado, lo que significa que los datos están codificados o no se pueden leer. Inspeccionar los paquetes de red puede requerir descifrar los datos mediante las claves privadas apropiadas.

## Cómo capturar paquetes con tcpdump

Anteriormente, aprendiste que un **usuario root (raíz) o superusuario de Linux**  tiene privilegios importantes para modificar el sistema. También, viste que el comando **sudo** otorga temporalmente permisos importantes a usuarios específicos en Linux. Al igual que muchas otras herramientas de rastreo de paquetes, deberás tener privilegios a nivel de administrador para capturar el tráfico de red mediante tcpdump. Esto significa que tendrás que iniciar sesión como usuario root o tener la capacidad de usar el comando sudo. Aquí se muestra un desglose de la sintaxis tcpdump para capturar paquetes:

sudo tcpdump [-i interface] [option(s)] [expression(s)]

- El comando sudo tcpdump comienza a ejecutar tcpdump con permisos importantes como sudo. 
    
- El parámetro -i especifica la interfaz de red para capturar el tráfico de red. Debes especificar una interfaz de red desde la que capturar para comenzar a capturar paquetes. Por ejemplo, si especificas -i any, detectarás el tráfico de todas las interfaces de red del sistema. 
    
- Las option(s) son facultativas y te brindan la capacidad de alterar la ejecución del comando. Las expression(s) son una forma de filtrar aún más los paquetes de tráfico de red para que puedas aislarlo. En la siguiente sección, aprenderás más sobre las option(s) y expression(s).
    

**Nota**: Antes de que puedas comenzar a capturar tráfico de red, debes identificar qué interfaz de red deseas usar para capturar paquetes. Puedes usar el indicador -D para enumerar las interfaces de red disponibles en un sistema.

## Opciones

Con tcpdump, puedes aplicar opciones, también conocidas como indicadores, al final de los comandos para filtrar el tráfico de red. Las opciones cortas se abrevian y se representan con un guión y un solo carácter como -i. Las opciones largas, en tanto, se explican con un guión doble como --interface. Tcpdump tiene más de 50 opciones que puedes explorar a través de [la página man](https://www.tcpdump.org/manpages/tcpdump.1.html). Aquí, examinarás un par de opciones claves de tcpdump, que incluyen cómo escribir y leer archivos de captura de paquetes.

**Nota**: Las opciones distinguen entre mayúsculas y minúsculas. Por ejemplo, una -w minúscula es una opción separada con un uso diferente que la opción con una -W mayúscula.

**Nota**: Las opciones de tcpdump que se escriben mediante opciones cortas se pueden escribir con o sin un espacio entre la opción y su valor. Por ejemplo, sudo tcpdump -i any -c 3 y sudo tcpdump -iany -c3 son comandos equivalentes.

### **-w**

Con el indicador -w, puedes escribir o guardar los paquetes de red rastreados en un archivo de captura de paquetes en lugar de solo imprimirlos en la terminal. Esto resulta de mucha utilidad  porque puedes consultar este archivo guardado para su posterior análisis. En este comando, tcpdump captura el tráfico de todas las interfaces de red y lo guarda en un archivo de captura de paquetes llamado packetcapture.pcap:

### sudo tcpdump -i any -w packetcapture.pcap

### **-r**

Con el indicador -r, puedes leer un archivo de captura de paquetes especificando el nombre del archivo como parámetro. Aquí te mostramos un ejemplo de un comando tcpdump que lee un archivo llamado packetcapture.pcap:

### sudo tcpdump -r packetcapture.pcap

### **-v**

Como ya viste, los paquetes contienen mucha información. De forma predeterminada, tcpdump no imprimirá toda la información de un paquete. Esta opción te permite controlar la cantidad de información de paquetes que deseas que tcpdump imprima.

Existen tres niveles de verbosidad que puedes usar según la cantidad de información del paquete que deseas que tcpdump imprima. Los niveles son -v, -vv, y -vvv. El nivel de verbosidad aumenta con cada v agregada. La opción más verbosa (abundancia de detalles) puede resultar útil si buscas información de paquetes, como los detalles de los campos de encabezado IP. A continuación, se muestra un ejemplo de un comando tcpdump que lee el archivo packetcapture.pcap:

### sudo tcpdump -r packetcapture.pcap -v

### **-c**

La opción -c significa conteo. Esta opción te permite controlar cuántos paquetes capturará tcpdump. Por ejemplo, especificar -c 1 imprimirá un solo paquete, mientras que -c 10 imprimirá 10. Este ejemplo le indica a tcpdump que solo capture los primeros tres paquetes que rastrea desde any (cualquier) interfaz de red:

### sudo tcpdump -i any -c 3

### **-n**  

De forma predeterminada, tcpdump realizará la resolución de nombres. Esto significa que tcpdump convierte automáticamente las direcciones IP en nombres. También resolverá puertos a servicios comúnmente asociados que usan estos puertos. Esto puede ser problemático porque tcpdump no siempre es preciso en la resolución de nombres. Por ejemplo, tcpdump puede capturar tráfico desde el puerto 80 y traducir automáticamente el puerto 80 a HTTP en la salida. Aun así, esto es engañoso porque el puerto 80 no siempre va a utilizar HTTP, sino que podría estar utilizando un protocolo diferente.

Además, la resolución de nombres utiliza lo que se conoce como una búsqueda inversa de DNS, que es una consulta que busca el nombre de dominio asociado con una dirección IP. Si realizas una búsqueda inversa de DNS en el sistema de un atacante, puede que se les avise que los estás investigando a través de sus registros de DNS.

El uso del indicador -n deshabilita este mapeo automático de números a nombres y se considera la mejor práctica al rastrear o analizar el tráfico. El uso de -n no resolverá los nombres de host, mientras que -nn no resolverá _ni_ los nombres de host ni los puertos. Aquí podrás ver un ejemplo de un comando tcpdump que lee el archivo packetcapture.pcap con verbosidad (abundancia de detalles) y deshabilita la resolución de nombres:

### sudo tcpdump -r packetcapture.pcap -v -n

**Consejo profesional:** Puedes combinar las opciones. Por ejemplo, -v y -n se pueden combinar como -vn. Pero, si una opción acepta un parámetro justo después de él como -c 1 o -r capture.pcap, entonces no podrás combinarlas.

## Expresiones

El uso de expresiones de filtro en comandos tcpdump también es opcional, pero puede resultar útil saber cómo y cuándo usar expresiones de filtro durante el análisis de paquetes. Existen muchas maneras de utilizar las expresiones de filtro.

Si deseas buscar tráfico de red por protocolo en específico, puedes utilizar expresiones de filtro para aislar los paquetes de red. Por ejemplo, puedes filtrar para encontrar solo tráfico IPv6 mediante la expresión de filtro ipv6.

También puedes usar operadores booleanos como and (y), or (o) o not (no) para filtrar aún más el tráfico de red para direcciones IP específicas, puertos y más. El siguiente ejemplo lee el archivo packetcapture.pcap y combina dos expresiones ipv4 and port 80 con el operador booleano and (y):

sudo tcpdump -r packetcapture.pcap -n 'ipv4 and port 80'

**Consejo profesional:** Puedes usar comillas simples o dobles para asegurarte de que tcpdump ejecute todas las expresiones. También puedes usar paréntesis para agrupar y priorizar diferentes expresiones. Agrupar expresiones es útil para comandos complejos o largos. Por ejemplo, el comando ipv4 and (port 80 or port 443) le indica a tcpdump que priorice la ejecución de los filtros encerrados entre paréntesis antes de filtrar para IPv4.

## Interpretación de la salida

Una vez que ejecutes un comando para capturar paquetes, tcpdump imprimirá la salida del comando como los paquetes rastreados. En la salida, tcpdump imprime una línea de texto para cada paquete con cada línea, comenzando con una marca de tiempo. Aquí se muestra un ejemplo de un comando y la salida para un solo paquete TCP:

sudo tcpdump -i any -v -c 1

Este comando le indica a tcpdump que capture paquetes en interfaz de red -i any. La opción -v imprime el paquete con información detallada y la opción -c 1 imprime solo un paquete. Esta es la salida de este comando:  

![Salida de un comando tcpdump con etiquetas para la marca de tiempo, IP de origen, puerto de origen, IP de destino y puerto de](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/X2yEkUQRTGmI2S7Zbfw85w_1e1cd8213c4a45b0b30af29314a71ff1_wTeUZnYkSjvJHu1fjX6wHsFO-LD1iNiogOU8vX28JWfcyigIU3J_hJz2u4veJemhbq3EfuQbqtqeiYmpmGQGSTDOqH-tpOY6J34b3J7JxceCNPribMnPpRyz3UmJnlwGZZTpDa_1mt2ybgGKuY6FQQ?expiry=1701734400000&hmac=pIfxEzo3RyrnJUTwxihcFCHuvUYZnMOr9brfvhJDLlw)

1. **Marca de tiempo**: La salida comienza con la marca de tiempo, que empieza con horas, minutos, segundos y fracciones de segundo. 
    
2. **IP de origen:** El origen del paquete lo proporciona su dirección IP de origen.
    
3. **Puerto de origen:** Este número de puerto es donde se originó el paquete.
    
4. **IP de destino:** La dirección IP de destino es donde se transmite el paquete.
    
5. **Puerto de destino:** Este número de puerto es donde se transmite el paquete.
    

La salida restante contiene detalles de la conexión TCP e incluye indicadores y número de secuencia. La información de options es información de paquetes adicionales que proporcionó la opción -v.

## Conclusiones clave

En seguridad, es probable que termines utilizando herramientas de análisis de protocolos de red como tcpdump. Es importante disponer de los conocimientos para capturar, filtrar e interpretar paquetes de red en la línea de comandos.

## Recursos para obtener más información

- Puedes acceder a más información con los [tutoriales y guías](https://www.tcpdump.org/) de tcpdump, que incluyen recursos educativos adicionales.
    
- Para conocer más sobre el uso de expresiones para filtrar el tráfico, lee el [tutorial de tcpdump a cargo de Daniel Miessler](https://danielmiessler.com/study/tcpdump/).
![[Pasted image 20231203003258.png]]
![[Pasted image 20231203003419.png]]
![[Pasted image 20231203003456.png]]
![[Pasted image 20231203003732.png]]
![[Pasted image 20231203003927.png]]
![[Pasted image 20231203004249.png]]
![[Pasted image 20231203004335.png]]
![[Pasted image 20231203004419.png]]
![[Pasted image 20231203004538.png]]
![[Pasted image 20231203004710.png]]
![[Pasted image 20231203004941.png]]
![[Pasted image 20231203005038.png]]
Recuerda, el modelo TCP/IP es un marco que se utiliza para visualizar cómo los datos se organizan y transmiten a través de una red. La capa de Internet acepta y entrega paquetes para la red. Allí también funciona el protocolo de Internet
como la base para todas las comunicaciones en Internet. Es responsable de asegurar 
que los paquetes lleguen seguros a sus destinos. El protocolo de Internet actúa como un mensajero que entregando un sobre. En lugar de usar la información de entrega que se encuentra en el sobre, el protocolo de Internet utiliza la información del encabezado, como las direcciones IP. Luego determina la mejor ruta disponible para los paquetes, y así los hosts pueden enviar y recibir datos. 
Como ya sabrás, los paquetes IP contienen encabezados. Estos contienen campos de datos esenciales para la transferencia de datos a su destino previsto. Diferentes protocolos usan distintos encabezados. Existen dos versiones del protocolo de Internet: IPv4, que se considera la base de las comunicaciones en Internet, de IPv6, que es la versión más reciente del protocolo de Internet. Recuerda, diferentes protocolos utilizan distintos encabezados.
![[Pasted image 20231203010227.png]]
![[Pasted image 20231203010246.png]]


## Detection
The prompt discovery of security events

## Analysis
The investigation and validation of alerts


Challenges in the detection and analysis phase
 - Imposible to detect everything
 - High volumes of alerts
 Como has aprendido, un sistema de detección de intrusiones (IDS) puede detectar posibles intrusiones y enviar alertas a los analistas de seguridad para que investiguen la actividad sospechosa. Estos, además, pueden utilizar las herramientas de gestión de eventos e información de seguridad (SIEM) para detectar, recopilar y analizar datos de seguridad.

También has aprendido que la detección presenta desafíos. Incluso los mejores equipos de seguridad pueden no detectar amenazas reales por distintas razones. Por ejemplo, las herramientas de detección pueden encontrar únicamente aquello que los equipos de seguridad han configurado para que monitoreen. Si no están configuradas correctamente, es posible que no identifiquen actividades sospechosas, y que los sistemas queden vulnerables a ataques. Por esto, es importante que los equipos de seguridad utilicen métodos adicionales de detección para aumentar su cobertura y precisión.

### **Caza de amenazas**

Las amenazas evolucionan y los atacantes avanzan en sus tácticas y técnicas. La detección automatizada y basada en la tecnología puede resultar insuficiente a la hora de mantenerse al día con el panorama de amenazas en constante evolución. La detección impulsada por el ser humano, como la caza de amenazas, combina el poder de la tecnología con un elemento humano para así descubrir amenazas ocultas que las herramientas de detección no logran captar.

**La caza de amenazas** es la búsqueda proactiva de amenazas en una red. Los profesionales de la seguridad la utilizan para descubrir actividades maliciosas que no fueron identificadas por las herramientas de detección y como una forma de llevar a cabo un análisis más detallado de las detecciones. También se utiliza para detectar amenazas antes de que ocasionen daños. Por ejemplo, para las herramientas de detección es difícil identificar el malware sin archivos. Esta es una forma de software malicioso que utiliza técnicas sofisticadas de evasión, como esconderse en la memoria en lugar de usar archivos o aplicaciones, lo que le permite eludir los métodos tradicionales de detección, como el análisis de firmas. La caza de amenazas utiliza la combinación de análisis humano activo y tecnología para identificar amenazas como el malware sin archivos. 

**Nota**: Los especialistas en caza de amenazas son conocidos como cazadores de amenazas. Los cazadores de amenazas investigan amenazas y ataques emergentes y luego determinan la probabilidad de que una organización sea vulnerable a un ataque en particular. Para lograrlo, utilizan una combinación de inteligencia sobre amenazas, indicadores de compromiso, indicadores de ataque y aprendizaje automático para buscar amenazas en una organización.

### **Inteligencia sobre amenazas**

Las organizaciones pueden mejorar sus capacidades de detección si están al tanto del panorama de amenazas en evolución y comprenden la relación entre su entorno y los agentes de amenaza. Para conocer mejor las amenazas se utiliza la **inteligencia sobre amenazas**, que consiste en información basada en evidencia que proporciona contexto acerca de amenazas existentes o emergentes. 

La inteligencia sobre amenazas puede provenir de fuentes privadas o públicas como las siguientes:

- **Informes de la industria**: Estos, a menudo, incluyen detalles sobre las tácticas, técnicas y procedimientos (TTP) del atacante.
    
- **Avisos gubernamentales:** Al igual que los informes de la industria, los avisos gubernamentales ofrecen información sobre los TTP de los atacantes. 
    
- **Fuentes de datos de amenazas**: Proporcionan información relacionada con amenazas, la cual puede utilizarse como protección contra atacantes sofisticados, como las **amenazas persistentes avanzadas (APT)**. Las APT son instancias en las que un agente de amenaza mantiene acceso no autorizado a un sistema durante un período prolongado de tiempo. Los datos suelen ser una lista de indicadores, como direcciones IP, dominios y hashes de archivos.
    

**Nota**: Las fuentes de datos de inteligencia de amenazas son importantes para agregar contexto a las detecciones, aunque no deben ser lo único que consideres a la hora de detectar y es necesario evaluarlas antes de ser utilizadas en una organización.

### **Ciberengaño**

Se denomina ciberengaño a las técnicas que engañan deliberadamente a los agentes de amenaza con el objetivo de aumentar la detección y mejorar las estrategias defensivas.

Los **honeypots** (sistemas trampa o señuelos) son un ejemplo de un mecanismo activo de defensa cibernética que utiliza tecnología del engaño. Los honeypots son sistemas o recursos que se crean como señuelos vulnerables a ataques con el propósito de atraer posibles intrusos. Por ejemplo, se puede tener un archivo falso con la etiqueta _Información de tarjetas de crédito_ _de clientes - 2022_ para engañar a los agentes de amenaza y que estos accedan al archivo porque parece legítimo. Una vez que un agente de amenaza intenta acceder a este archivo, los equipos de seguridad son alertados.

## Conclusiones clave

Se pueden implementar diversos métodos de detección para identificar y localizar eventos de seguridad en un entorno. Es esencial que las organizaciones utilicen una gran variedad de métodos, herramientas y tecnologías de detección para adaptarse a un panorama de amenazas en constante evolución, y proteger mejor los activos.

## Recursos para obtener información adicional

Si deseas explorar más sobre la caza de amenazas y la inteligencia sobre amenazas, puedes acudir a recursos como los siguientes:

- Un [repositorio informativo sobre la caza de amenazas del](https://www.threathunting.net/) Proyecto ThreatHunting 
    
- Investigación sobre [hackers patrocinados por el estado](https://blog.google/threat-analysis-group/) realizada por el Grupo de Análisis de Amenazas (TAG)
## Indicadores de compromiso

Los **indicadores de compromiso** (**IoC**) son evidencias observables que sugieren indicios de un posible incidente de seguridad. Los IoC trazan piezas específicas de evidencia que están vinculadas con un ataque, como un nombre de archivo asociado con un tipo de malware. Se puede pensar en un IoC como evidencia que apunta a algo que ya ha sucedido, como notar que un objeto de valor ha sido robado del interior de un automóvil. 

Los **indicadores de ataque** (**IoA**) son la serie de eventos observados que indican un incidente en tiempo real. Los IoA identifican el comportamiento de un atacante, incluidos sus métodos e intenciones.

Esencialmente, los IoC ayudan a identificar el _quién_ y el _qué_ de un ataque después de que haya tenido lugar, mientras que los IoA se centran en encontrar el _por qué_ y el _cómo_ de un ataque en curso o desconocido. Por ejemplo, observar un proceso que establece una conexión de red es un ejemplo de un IoA. El nombre de archivo del proceso y la dirección IP con la que se contactó el proceso son ejemplos de los IoC relacionados.

**Nota**: Los indicadores de compromiso no siempre son una confirmación de que ha ocurrido un incidente de seguridad. Los IoC pueden ser el resultado de errores humanos, mal funcionamiento del sistema y otras razones no relacionadas con la seguridad.

## Pirámide del dolor

No todos los indicadores de compromiso son igual de importantes para los profesionales de seguridad y es clave que los conozcan en detalle, para poder detectarlos y responder a ellos de manera rápida y efectiva. Es por esto que el investigador de temas de seguridad David J. Bianco creó el concepto de la [pirámide del dolor](http://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html), que tiene el objetivo de mejorar la forma en que se utilizan los indicadores de compromiso en la detección de incidentes.

![Un triángulo dividido en seis niveles describe seis indicadores de compromiso, cada uno con un nivel de dificultad correspond](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/eVKgkctNSACdLC3QbXnnRQ_00580d15866a4fa1921ba71c0811e9f1_0qZbKm7U6snU1008iA6KP06C9RUDyhRvxJIGZHBK3vsGtq24U7NkzPaMeRCtDXlfhFNhUunhntcxKY__y91sW9Nsnu-K_kMog6im5eKSRcgPHGgWRThn4HIRTK0QhEqx_j2L-EfSi9P75frrQFKfDw?expiry=1701820800000&hmac=zUhK3659gQrW5c93H1gz80h3h-ZZYsdb85ty89pdYa8)

La pirámide del dolor establece la relación entre los indicadores de compromiso y el nivel de dificultad que los agentes de amenaza deben enfrentar, cuando los indicadores de compromiso son bloqueados por los equipos de seguridad. De esta manera, enumera los diferentes tipos de indicadores de compromiso que los profesionales de seguridad utilizan para identificar actividades maliciosas. 

Cada tipo de indicador de compromiso se clasifica en niveles de dificultad. Estos representan los niveles de “dolor” que enfrenta un atacante cuando los equipos de seguridad bloquean la actividad asociada con el indicador de compromiso. Por ejemplo, el bloqueo de una dirección IP asociada con un agente de amenaza se etiqueta como fácil porque estos pueden usar sin dificultad distintas direcciones IP para sortear esto y así continuar con su ataque. Si los equipos de seguridad logran bloquear los IoC ubicados en la parte superior de la pirámide, más difícil se vuelve para los atacantes continuar con su misión. A continuación, se presenta un desglose de los diferentes tipos de indicadores de compromiso que se encuentran en la pirámide del dolor. 

1. **Valores hash**: Hashes que corresponden a archivos maliciosos conocidos. A menudo se utilizan para proporcionar referencias únicas respecto a muestras específicas de malware o archivos involucrados en una intrusión.
    
2. **Direcciones IP**: Una dirección de protocolo de Internet como 192.168.1.1
    
3. **Nombres de dominio**: Una dirección web como www.google.com 
    
4. **Artefactos de red**: Evidencia observable creada por agentes de amenaza en una red. Por ejemplo, la información que se encuentra en los protocolos de red, como las cadenas del agente de usuario (User-Agent strings). 
    
5. **Artefactos de host:** Evidencia observable creada por agentes de amenaza en un host. Un host es cualquier dispositivo que esté conectado en una red. Por ejemplo, el nombre de un archivo creado por malware.
    
6. **Herramientas**: Software que es utilizado por un agente de amenaza para lograr su objetivo. Por ejemplo, los atacantes pueden usar herramientas de descifrado de contraseñas (password cracking) como John the Ripper para realizar ataques de contraseña y obtener acceso a una cuenta.
    
7. **Tácticas, técnicas y procedimientos (TTP)**: Comportamiento de un agente de amenaza. Las tácticas tienen que ver con la visión general de alto nivel del comportamiento. Las técnicas proporcionan descripciones detalladas del comportamiento en relación a la táctica. Los procedimientos son descripciones muy detalladas de la técnica. Los TTP son los más difíciles de detectar.
## Agregar contexto a las investigaciones

Anteriormente, has aprendido sobre la pirámide del dolor, que describe la relación entre los indicadores de compromiso y el nivel de dificultad que experimentan los agentes de amenaza cuando los indicadores de compromiso son bloqueados por los equipos de seguridad. También aprendiste sobre diferentes tipos de IoC pero, como sabes, no todos los IoC son iguales. Los agentes de amenaza pueden lograr evadir la detección y continuar comprometiendo los sistemas aunque su actividad relacionada con los IoC esté bloqueada o limitada.

Por ejemplo, identificar y bloquear una sola dirección IP asociada con una actividad maliciosa no proporciona una visión amplia de un ataque, ni impide que un agente de amenaza continúe su actividad. Centrarse en una sola parte de la evidencia es como fijarse en una sola parte de un cuadro: se pierde el panorama general.

![Una mujer observa una sola parte de un cuadro grande.](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/NIsyfF7gR5i2_BtHic8IoQ_bd3ce9cf8a5545f094ba49f1cdc255f1_Q5tAuOqXjM1xTxk3UVAnjmh4AceFu3dLDomjXndmq03mwemuVa0xxmBWH3-21nxNsjEgiABIarLgHnyZ4ZtvWenphMQTC7897P46aLXgihj68VviWfKn5GXh0P29cxBwcjTahx-REmjK-GU_hjS6Hg?expiry=1701820800000&hmac=W7lh4j3h7WQbJLiJ7ph1ezUpULmsl-uz5AhWSmVNY8c)

Los analistas de seguridad necesitan expandir el uso de los IoC para poder agregar contexto a las alertas. **La inteligencia sobre amenazas** es la información basada en evidencia que proporciona contexto sobre amenazas existentes o emergentes. Al acceder a información adicional relacionada con los IoC, los analistas de seguridad pueden ampliar su punto de vista para observar el panorama general y construir una narrativa que ayude a informar sus acciones de respuesta.

![Una mujer ve un cuadro grande de un elefante en su totalidad.](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/SkRtZw3xQUSeb6_bHIdv5A_9ba0414546c1431098878bb158258bf1_G7IX9bGS4agkVUEoWCkdG95c_GUz0tjz4u8bPEjxnny5QwzT-Pg50jd7kXo-5frgy2lvqypl20VETB5SEvQrF5vaHMIjexLdM4Ybc5tq--Tp3GGk5K7YdNJ3T2WUEFNMkqOozyJ6WJb-GmFqbJ5vKA?expiry=1701820800000&hmac=s6IxjnP02WDa7nqkiVntttn8iXsEjcB5D3T1eEfsC_4)

Al agregar contexto a un IoC, por ejemplo, mediante la identificación de otros artefactos relacionados con la dirección IP sospechosa, como comunicaciones de red dudosas o procesos inusuales, los equipos de seguridad pueden  tener una imagen más concreta de un incidente. Este contexto puede ayudar a los equipos de seguridad a detectar incidentes de seguridad más rápido y adoptar un enfoque más informado en su respuesta.

## El poder del "crowdsourcing" (externalización abierta de tareas)

El **crowdsourcing**, también denominado colaboración colectiva, es la práctica de recopilar información utilizando los aportes y la colaboración del público. Las plataformas de inteligencia sobre amenazas lo utilizan para reunir información de la comunidad global de ciberseguridad. Tradicionalmente, la respuesta a incidentes de una organización se realizaba de forma aislada; un equipo de seguridad recibía y analizaba una alerta, y luego procedía a remediarla, sin haber contemplado perspectivas adicionales acerca de cómo abordarla. De esta manera, sin el crowdsourcing, los atacantes podían llevar a cabo los mismos ataques contra distintas organizaciones.

![Un atacante ataca con éxito a cinco organizaciones diferentes.](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/U1N4CwEQRfm7EDpnl7m6sw_4316381e98284fceb197833490cfd4f1_8WDUhq57Ulofnxd8zRTRCiZ_XEPkRtXGLdeUI_4KAo-tQ_g_H-Y4Mf9KzN610_3kD332fofMMJzkNeBm_dXSbViw_Heb8nNYMKhRI1LLgnWwbrB3B7Vm-gDQarfU98Fzx-YQ8Ao2d_SisxnrP6domQ?expiry=1701820800000&hmac=BrOuyrG3-ZtNChFw48CgqFqt5fTjQOldq1Ebu_aY5DQ)

Gracias al crowdsourcing, en cambio, las organizaciones aprovechan los conocimientos de millones de otros profesionales de la ciberseguridad, incluidos, entre otros, los vendedores de productos de ciberseguridad, organismos públicos y proveedores de servicios en la nube. Esta práctica permite a personas y organizaciones de la comunidad de la ciberseguridad mundial compartir y acceder abiertamente a una colección de datos de inteligencia sobre amenazas, lo cual ayuda a mejorar continuamente las tecnologías y metodologías de detección. 

Entre los ejemplos de organizaciones de intercambio de información, se encuentran los Centros de Intercambio y Análisis de Información (ISAC), que se centran en recopilar inteligencia sobre amenazas dirigidas a sectores específicos y compartirla con empresas que operan en esos sectores concretos, como pueden ser los de energía o los de salud. Por su parte, la **inteligencia de fuentes abiertas (OSINT)** es la recopilación y análisis de información procedente de fuentes de acceso público para generar inteligencia utilizable. La OSINT también se puede utilizar como método para recopilar información relacionada con agentes de amenaza, amenazas, vulnerabilidades y más.

Estos datos de inteligencia sobre amenazas se utilizan para mejorar los métodos y técnicas de detección de productos de seguridad, como las herramientas de detección o el software antivirus. Por ejemplo, los atacantes suelen realizar los mismos ataques contra múltiples objetivos, con la esperanza de que uno de ellos sea exitoso. Si una organización detecta un ataque y publica inmediatamente los detalles del incidente, como archivos maliciosos, direcciones IP o URL, en herramientas como VirusTotal, esta inteligencia sobre amenazas puede ayudar a otras organizaciones a defenderse contra el mismo ataque.

![Gracias al crowdsourcing de inteligencia sobre amenazas, se impide que un agente de amenaza ataque organizaciones.](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/FYHrMKf5TpazqrQXWitb0Q_9d95808b21514755b22d8d8eed3e2df1_70uAvL3RL-4HOggJOTLCI2e7zyoCIASKVFshv1ijAIahfhhL82hamQJ3GmG01iS72_hdV_4cgdGDn37-TnRSKpNnzUOwcRIKZZLFLzr8R-vgaJc9r7i5NXbtqG6WPH4JNuNq-Tq-LflbQmdR0brSfA?expiry=1701820800000&hmac=CIOlw1YPmGyDA_GvW8DcTkvjikZursEZKEOeSXPWQ3g)

## VirusTotal 

[**VirusTotal**](https://www.virustotal.com/gui/home) es un servicio que permite a cualquier persona analizar archivos, dominios, URL y direcciones IP sospechosos en busca de contenido malicioso. VirusTotal también ofrece servicios y herramientas adicionales para uso empresarial. Esta lectura se centra en el sitio web de VirusTotal, que está disponible para uso gratuito y no comercial.

Esta herramienta se puede utilizar para analizar archivos, direcciones IP, dominios y URL sospechosos, a fin de detectar amenazas de ciberseguridad, como el software malicioso. Los usuarios pueden enviar y verificar artefactos como hashes de archivos o direcciones IP para obtener informes de VirusTotal. Estos proporcionan información adicional sobre si un IoC se considera malicioso o no, cómo ese IoC está conectado a, o relacionado con, otros IoC en el conjunto de datos y más.

![Una captura de pantalla de la página de inicio de VirusTotal.](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/ZN3F1gQcQ4627k6mhxsIHA_6d0784f7d8274ba69a38e70ec1ae7bf1_AzNA7fTociJEDqgkS0l2YH3wdvt-fnAi_LQTd_dwbsKnq9qOWWz2nkJoaFcy0LgltpdOYk2nh6d1YTtdGXSBXchSyUnfQk6PKAOxsJi6SAIbePay2u-2jDRGZisGnt-VZbNXLK5lbmW6yzcFVETQ8Q?expiry=1701820800000&hmac=BOmoEysnoNT7JyWuECGkXh7lsfGt1kDU3Ac46xijhrM)

Aquí se presenta un desglose del resumen de los informes:

![Una captura de pantalla de un resumen de informes de VirusTotal.](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/l98C0ItLQEyqTPzjRn1pYw_16ef51cfd9b048f08e9f63640fa4e5f1_8CxcxPbhAo6I8jTCUUw4XEulWKHU2r3oSPkF8Jhlrp6En__fEtLvj26RRwm9L9toDQHhmtZ2qI5Le3Pqb0urQZKdSAUFIdNQeCND-Q3pb0BoaXGXCkhGNISoZuphMf9VbwC87-XTDqBvPuYxpLaBQ?expiry=1701820800000&hmac=selZOko5CUBKNeAbrmITg9RnAK-mPNzXSJxuzLoxx1s)

1. **Detection (Detección):** La pestaña Detection proporciona una lista de proveedores de seguridad externos y sus veredictos de detección sobre un IoC. Por ejemplo, los proveedores pueden catalogar su veredicto de detección como malicioso, sospechoso, inseguro, entre otros.
    
2. **Details (Detalles)**: Esta pestaña proporciona información adicional extraída de un análisis estático del IoC. En esta pestaña se puede encontrar información sobre los distintos hashes, tipos de archivos, tamaños de archivo y encabezados, hora de creación y detalles sobre el primer y último envío.
    
3. **Relations (Relaciones)**: La pestaña Relations proporciona los IoC relacionados que están conectados de alguna manera a un artefacto, como las URL, dominios, y direcciones IP contactados y los archivos soltados si el artefacto es un ejecutable.
    
4. **Behavior (Comportamiento)**: La pestaña Behavior contiene información relacionada con la actividad y los comportamientos de un artefacto que se han observado después de ejecutarlo en un entorno controlado, como uno de pruebas (sandbox). Esta información incluye tácticas y técnicas detectadas, comunicaciones de red, acciones de sistemas de registro y archivos, procesos, entre otros.
    
5. **Community (Comunidad):** La pestaña Community es donde los miembros de la comunidad VirusTotal, como los profesionales de seguridad o los investigadores, pueden dejar comentarios e ideas sobre el IoC.
    
6. **Vendors’ ratio and community Score (Ratio de proveedores y puntuación de la comunidad)**: La puntuación que se muestra en la parte superior del informe es el ratio de proveedores, que indica cuántos proveedores de seguridad han marcado el IoC como malicioso. Debajo de esta puntuación también figura la de la comunidad, que se basa en los aportes de los usuarios de VirusTotal. Cuantas más detecciones tenga un archivo y mayor sea la puntuación de la comunidad, más probable es que sea malicioso.
    

**Nota**: Los datos subidos a VirusTotal se compartirán públicamente con toda la comunidad de VirusTotal. Es necesario tener cuidado al enviar información y asegurarse de no subir información personal.

## Otras herramientas

Existen otras herramientas de investigación que se pueden utilizar para analizar los IoC, que también pueden compartir los datos con la comunidad.

### **Jotti's malware scan**

[Jotti's malware scan](https://virusscan.jotti.org/) es un servicio gratuito que te permite analizar archivos sospechosos con varios programas antivirus. Hay algunas limitaciones en cuanto a la cantidad de archivos que se pueden enviar.

### **Urlscan.io**

[Urlscan.io](https://urlscan.io/) es un servicio gratuito que escanea y analiza las URL y proporciona un informe detallado que resume la información de la URL.

### **CAPE Sandbox**

[CAPE Sandbox](https://capesandbox.com/analysis/) es un servicio de código abierto utilizado para automatizar el análisis de archivos sospechosos. En un entorno aislado, se analizan archivos maliciosos como el malware, cuyo comportamiento se describe en un informe exhaustivo.

### **MalwareBazaar**

[MalwareBazaar](https://bazaar.abuse.ch/browse/) es un repositorio gratuito para muestras de software malicioso. Estas muestras son una gran fuente de inteligencia sobre amenazas que se puede utilizar con fines de investigación.

![[Pasted image 20231203203211.png]]
![[Pasted image 20231203203241.png]]
![[Pasted image 20231203203301.png]]
![[Pasted image 20231203203526.png]]
![[Pasted image 20231203203537.png]]
![[Pasted image 20231203203912.png]]
![[Pasted image 20231203203924.png]]
![[Pasted image 20231203204139.png]]
![[Pasted image 20231203204316.png]]

## Benefits of documentation
- Transparency
- Standardization
- Clarity

## *Chain of custody*
The process of documentation evidence possession and control during an incident lifecycle.

![[Pasted image 20231203205300.png]]
## *Broken chain of custody*
Inconsistencies in the collection and logging of evidence in the chain of  custody.

## *Chain of custody establishes*
- Integrity
- Reliability
- Accuracy

### **Conoce a tu público**

Antes de que comiences a crear la documentación, considera a tu público y sus necesidades. Por ejemplo, un resumen de incidentes escrito para un gerente de un centro de operaciones de seguridad (SOC) estará redactado de manera diferente a uno que haya sido elaborado para un director ejecutivo (CEO). El gerente del SOC puede entender el lenguaje técnico del campo de la seguridad, pero un CEO podría no hacerlo. Por lo tanto, es necesario que adaptes tu documento para satisfacer las necesidades de tu público.

### **Sé conciso**

Es posible que se te asigne la tarea de crear documentación larga, como un informe. Pero cuando resulta demasiado extensa, puede haber resistencia a utilizarla. Para asegurarte de que tu documentación sea útil, establece el propósito desde un comienzo. Esto ayuda a las personas a identificar rápidamente el objetivo del documento. Por ejemplo, los resúmenes ejecutivos describen los principales hechos de un incidente al comienzo de un informe final. Este resumen debe ser breve, de manera que pueda leerse por encima, fácilmente, para identificar los principales hallazgos.

### **Actualízalo con frecuencia**

En seguridad, se descubren y explotan nuevas vulnerabilidades constantemente. La documentación debe revisarse y actualizarse regularmente para mantenerse al día con el panorama de amenazas en evolución. Por ejemplo, después de que se ha resuelto, una revisión integral de un incidente puede identificar brechas en los procesos y procedimientos que requieren cambios y actualizaciones. Al actualizar regularmente la documentación, los equipos de seguridad se mantienen bien informados y los planes de respuesta a incidentes permanecen actualizados.

### Playbook
A manual that provides details about any operational action.

![[Pasted image 20231203210042.png]]

## Types of playbooks
1. *Non-automated* Como el ejemplo del ataque DDoS
2. *Automated* Tareas como categorizar la severidad del incidente pueden llevarse acabo usando un manual automatizado. Las herramientas SOAR y SIEM pueden configurarse para automatizarlos.
3. *Semi-automated* Tareas tediosas, lentas o propensas al error se pueden automatizar. Los manuales semi automatizados pueden ayudar a  aumentar la productividad y agilizar la resolución.
![[Pasted image 20231203210545.png]]
![[Pasted image 20231203210557.png]]
![[Pasted image 20231203211021.png]]
![[Pasted image 20231203211031.png]]

## Triage
The prioritizing of incidents according to their level of importance or urgency.

Triage process
1. Receive and assess
2. Assign priority
3. Collect and analyze
## Questions to ask
- Is there anything out of the ordinary?
- Are there multiple failed login attempts?
- Did the login happen outside of normal working hours?
- Did the login happen outside of the network?
### **Recibir y evaluar**

Durante esta primera etapa del proceso de triaje, un analista de seguridad recibe una alerta de, por ejemplo, un **sistema de detección de intrusiones** (IDS). Es posible que recuerdes que un IDS es una aplicación que monitorea la actividad del sistema y alerta sobre posibles intrusiones. Luego, el analista revisa la alerta para verificar su validez y asegurarse de que la entiende en su totalidad. 

Esto implica recopilar la mayor cantidad de información posible sobre la alerta, incluidos, entre otros, los detalles sobre la actividad que desencadenó la alerta y los sistemas y activos involucrados. Aquí te presentamos algunas preguntas para tener en cuenta al verificar la validez de una alerta: 

- **¿Es la alerta un falso positivo?** Los analistas de seguridad deben determinar si la alerta es un problema de seguridad genuino o un **falso positivo**, o sea, una alerta que detecta incorrectamente la presencia de una amenaza.
    
- **¿Se activó esta alerta en el pasado?** En caso afirmativo, ¿cómo se resolvió? El historial de una alerta puede ayudar a determinar si es un problema nuevo o recurrente. 
    
- **¿La alerta se desencadena por una vulnerabilidad conocida?** Si una alerta es activada por una vulnerabilidad conocida, los analistas de seguridad pueden aprovechar los conocimientos existentes para determinar una respuesta adecuada y minimizar el impacto de la vulnerabilidad. 
    
- **¿Cuál es la gravedad de la alerta?** La gravedad de una alerta puede ayudar a determinar la prioridad de la respuesta para que los problemas críticos se eleven rápidamente.
    

### **Asignar prioridad**

Una vez que la alerta se ha evaluado y verificado adecuadamente como un problema de seguridad genuino, debe priorizarse en consecuencia. Los incidentes difieren en su impacto, tamaño y alcance, lo que afecta los intentos de respuesta. Para administrar el tiempo y los recursos, los equipos de seguridad deben priorizar la forma en que responden a varios incidentes, ya que no todos son iguales. A continuación, se detallan algunos factores a considerar al determinar la prioridad de un incide:

- **Impacto funcional:** Los incidentes de seguridad que tienen como objetivo sistemas de tecnología de la información impactan el servicio que estos sistemas brindan a sus usuarios. Por ejemplo, un incidente de ransomware puede afectar gravemente la confidencialidad, disponibilidad e integridad de los sistemas. Los datos pueden ser encriptados o eliminados, haciéndolos completamente inaccesibles para los usuarios. Considera cómo un incidente impacta en la funcionalidad existente para el negocio del sistema afectado.
    
- **Impacto de la información:** Los incidentes pueden afectar la confidencialidad, integridad y disponibilidad de los datos y la información de una organización. En un ataque de exfiltración de datos, los agentes de amenaza pueden robar datos confidenciales, que pueden pertenecer a organizaciones o usuarios externos. Considera los efectos que el compromiso de la información puede causar más allá de la organización. 
    
- **Recuperabilidad:** La forma en que una organización se recupera de un incidente depende del tamaño y el alcance del incidente y de la cantidad de recursos disponibles. En algunos casos, la recuperación podría no ser posible, como cuando un agente de amenaza roba con éxito datos privados y los comparte públicamente. Dedicar tiempo, esfuerzo y recursos en un incidente sin recuperabilidad puede ser un desperdicio. Es importante considerar si la recuperación es posible y si merece el tiempo y el costo.
    

**Nota**: Las alertas de seguridad suelen llegar con un nivel de prioridad o gravedad asignado que clasifica la urgencia de la alerta en función de un nivel de priorización.

### **Recopilar y analizar**

El paso final del proceso de triaje implica que el analista de seguridad realice un análisis exhaustivo del incidente. El análisis implica la recopilación de pruebas de diferentes fuentes, la realización de investigaciones externas y la documentación del proceso de investigación. El objetivo de este paso es recopilar suficiente información para tomar una decisión informada, a la hora de atender el incidente. Dependiendo de su gravedad, puede ser necesario elevarlo a un analista de nivel 2 o a un gerente. Los analistas y gerentes de nivel 2 podrían tener más conocimiento sobre el uso de técnicas avanzadas para atender el incidente.

## Beneficios del triaje

Al priorizar los incidentes en función de su impacto potencial, puede reducirse el alcance del impacto en la organización, ya que garantiza una respuesta oportuna. Algunos de los beneficios que el triaje tiene para los equipos de seguridad son: 

- **Gestión de recursos:** El triaje de las alertas permite a los equipos de seguridad enfocar sus recursos en las amenazas que requieren atención urgente. Esto ayuda a los miembros del equipo a evitar dedicar tiempo y recursos a tareas de menor prioridad y también podría reducir el tiempo de respuesta.
    
- **Enfoque estandarizado:** El triaje proporciona un enfoque estandarizado para el manejo de incidentes. La documentación del proceso, como los manuales de estrategias, ayuda a que las alertas pasen por un proceso iterativo, lo cual garantiza que se evalúen y validen correctamente. Esto hace que sean solo las alertas válidas las que pasen al siguiente nivel y sean investigadas.
![[Pasted image 20231203214019.png]]

## *Containment*
The act of limiting and preventing additional damage caused by an accident.

## *Eradication*
The complete removal of the incident elements from all affected systems.

## *Recovery*
The process of returning affected systems back to normal operations.

Al igual que un plan de respuesta a incidentes, un **plan de continuidad del negocio (BCP)** es un documento que describe los procedimientos para mantener las operaciones comerciales durante y después de una interrupción significativa. Un BCP ayuda a las organizaciones a garantizar que las funciones comerciales críticas puedan reanudarse o restaurarse rápidamente cuando ocurre un incidente.

Los analistas de seguridad de nivel inicial no suelen ser responsables del desarrollo y las pruebas de un BCP. Sin embargo, es importante que comprendas cómo los BCP proporcionan a las organizaciones una forma estructurada de responder y recuperarse de los incidentes de seguridad.

**Nota**: Los planes de continuidad del negocio no son lo mismo que los _planes de recuperación ante desastres_. Estos se utilizan para recuperar sistemas de información en respuesta a un hecho grave, que puede ir desde fallas de hardware hasta la destrucción de las instalaciones por un desastre natural, como una inundación.

### **Los impactos del ransomware en la continuidad del negocio**

Los impactos de un incidente de seguridad como el ransomware pueden ser devastadores para el funcionamiento de una organización. Los ataques de ransomware dirigidos a infraestructura crítica, como la de salud, pueden tener el potencial de causar interrupciones significativas. Dependiendo de la gravedad del ataque, pueden verse afectadas la accesibilidad, la disponibilidad y la prestación de servicios de salud esenciales. Por ejemplo, el ransomware puede cifrar datos, lo que resulta en la inhabilitación del acceso a los registros médicos y la imposibilidad de que los proveedores de atención médica accedan a los registros de los pacientes. A mayor escala, los incidentes de seguridad que tienen como objetivo los activos, sistemas y redes de infraestructura crítica también pueden comprometer la seguridad nacional y económica, y la salud y seguridad del público. La importancia de los BCP radica en que ayudan a minimizar las interrupciones en las operaciones para que se pueda acceder rápidamente a los servicios esenciales.

### **Estrategias de recuperación**

Cuando se produce una interrupción debido a un incidente de seguridad, las organizaciones deben tener algún tipo de plan de recuperación operativo para resolver el problema y poner los sistemas en pleno funcionamiento. Los BCP pueden incluir estrategias para la recuperación que se centran en retomar las operaciones normales. La resiliencia del sitio es un ejemplo de estrategia de recuperación.

### **Resiliencia del sitio**

La **resiliencia** es la capacidad de prepararse, responder y recuperarse de las alteraciones. Las organizaciones pueden diseñar sus sistemas para que sean resilientes y puedan continuar prestando servicios a pesar de enfrentar interrupciones. Un ejemplo es la resiliencia del sitio, que se utiliza para garantizar la disponibilidad de redes, centros de datos u otras infraestructuras cuando se produce una interrupción. Hay tres tipos de sitios de recuperación utilizados para la resiliencia del sitio:

- **Sitios calientes (Hot sites)**: Instalaciones completamente operativas que replican el entorno primario de una organización. Los sitios calientes pueden activarse inmediatamente cuando el sitio principal de una organización experimenta fallas o interrupciones.
    
- **Sitios tibios (Warm sites)**: Instalaciones que contienen una versión completamente actualizada y configurada del sitio caliente. A diferencia de estos, los sitios tibios no están completamente operativos y disponibles para su uso inmediato, pero pueden ponerse en funcionamiento rápidamente cuando se produce una falla o interrupción.
    
- **Sitios fríos (Cold sites**): Instalaciones de respaldo equipadas con parte de la infraestructura necesaria para operar el sitio de una organización. Cuando se produce una interrupción o falla, los sitios fríos pueden no estar listos para su uso inmediato y tal vez requieran trabajo adicional para poder operar.
![[Pasted image 20231203214913.png]]
![[Pasted image 20231203214926.png]]

## *Post- incident activity phase*
The process of reviewing an incident to identify areas for improvement during incident handling.

## *Final report*
Documentation that provides a comprehensive review of an incident.

## Questions to ask in an incident review meeting
- What happened?
- What time did it happen?
- Who discovered it?
- How did it get contained?
- What were the actions taken for recovery?
- What could have been done differently?

**Consejo profesional**: Antes de que un equipo organice una reunión sobre lecciones aprendidas, los organizadores deben asegurarse de que todos los asistentes lleguen preparados. Los organizadores de la reunión generalmente desarrollan y distribuyen una agenda de la reunión de antemano, la cual contiene los temas de discusión y garantiza que los asistentes estén informados y preparados. Además, se deben asignar con anticipación las funciones de quienes participarán en la reunión, incluido un moderador que dirija y facilite la discusión y un secretario que tome notas de la reunión.

### **Recomendaciones**

Las reuniones sobre lecciones aprendidas brindan oportunidades para el crecimiento y la mejora. Por ejemplo, los equipos de seguridad pueden identificar errores en las acciones de respuesta, brechas en los procesos y procedimientos o controles de seguridad ineficaces. Una reunión sobre lecciones aprendidas debe dar como resultado una lista de acciones prioritarias o recomendaciones prácticas destinadas a mejorar los procesos de manejo de incidentes y la postura de seguridad general de una organización. Esto garantiza que las organizaciones estén implementando las lecciones que han aprendido después de un incidente, de modo que no estén expuestas a experimentar el mismo incidente en el futuro. Algunos cambios que pueden llevarse a cabo incluyen actualizar y mejorar las instrucciones del manual de estrategias o poner en práctica nuevas herramientas y tecnologías de seguridad.

## Informe final

A lo largo de este curso, exploraste la importancia que tiene la documentación en el registro de detalles durante el ciclo de vida de respuesta a incidentes. Como punto de partida, la documentación de respuesta a incidentes debe describir el incidente teniendo en cuenta las cinco preguntas fundamentales a la hora de investigar un incidente: _quién_ (who), _qué_ (what), _dónde_ (where), _por qué_ (why) y _cuándo (where)._ Los detalles plasmados durante la respuesta a incidentes son importantes para desarrollar documentos adicionales al final del ciclo de vida.

Uno de los documentos fundamentales que se crea al término de un incidente es el **informe final**. Este proporciona una revisión integral del incidente. Los informes finales no están estandarizados, y sus formatos pueden variar según las organizaciones. Además, se pueden crear varios informes finales dependiendo de los públicos para los que estén escritos. Algunos ejemplos de elementos comunes que pueden encontrarse en un informe final son:

- **Resumen ejecutivo**: Un resumen de alto nivel del informe que incluye las principales conclusiones y los hechos esenciales relacionados con el incidente
    
- **Línea de tiempo**: Un cronograma detallado del incidente que incluye marcas de tiempo que muestran la secuencia de eventos que llevaron al incidente
    
- **Investigación**: Una compilación de las medidas que se tomaron durante la detección y el análisis del incidente. Por ejemplo, el análisis de un artefacto de red, como una captura de paquetes, revela información sobre qué actividades ocurren en una red.
    
- **Recomendaciones**: Una lista de medidas sugeridas para la prevención futura
    

**Consejo profesional**: Al escribir el informe final posterior a un incidente, considera el público para quien lo estás escribiendo. A menudo, estos informes serán leídos por ejecutivos de negocios y otros profesionales no relacionados con la seguridad, que no tienen la pericia para comprender los detalles técnicos. Tener en cuenta al público al escribir un informe final te ayudará a comunicar de manera efectiva los detalles más importantes.
![[Pasted image 20231203220030.png]]
![[Pasted image 20231203220534.png]]