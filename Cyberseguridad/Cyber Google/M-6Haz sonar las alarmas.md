![[Pasted image 20231130225152.png]]
### Semana 1: Introducción a la detección y respuesta a incidentes

![Cinco íconos muestran el curso seguido de las cuatro semanas secuencialmente de izquierda a derecha con la semana 1 resaltada](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/QDeeEuXbQDKsSOtvb4tvsQ_66daa61c6c134eb1970d4c4a55e91af1_74n3e8fu1lusMjBJwdQ2-Juh3sJo146X311Tj2tRdVrIxkD18vLqCsu_KUiVmsbYrxcQZBBucLeI4e2YU8bJQuKrxXnfzfjO3slwr5HXoloGhaCOTuiUrqptXm6iJLlb65G6EIPO5LtBxd_EUOEhwA?expiry=1701561600000&hmac=wZj6wjSz8JlQU4YiC016UXP3KLavWhaHM2d1tQSqs9E)

Se te presentará la detección y la respuesta a incidentes, y los pasos involucrados en dicho proceso. También explorarás cómo los profesionales de ciberseguridad verifican y responden frente a amenazas maliciosas.

### Semana 2: Monitoreo y análisis de redes

![Cinco íconos muestran el curso seguido de las cuatro semanas secuencialmente de izquierda a derecha con la semana 2 resaltada](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/vCmiUTUsTAOAwWYzALvyVg_012307e6898e4271bf3df2c8356a41f1__xjfa0a41OLRUu5J4tidAXzQevPhltmIyIS3GX4A_li27Yy5IjH1Dt4Mi_K84NXhtUl3SxeFOf_HRVSV09FedyzANh00r8xGbebXh9AV42LQQN6fZs-ST16p6no4_VYJZXokr_baj9UBp56cZULgUA?expiry=1701561600000&hmac=h8FzcngvdvYSfkjEXU-X0U6DY07ZwJ_wqJYK1WVBpgo)

Aprenderás la importancia del monitoreo de redes y cómo comprender el tráfico de red. Luego, explorarás cómo utilizar herramientas del analizador de protocolos de red, comúnmente conocidas como rastreador de paquetes. En particular, analizarás el tráfico de la red en busca de amenazas maliciosas y crearás comandos de filtrado para analizar el contenido de los paquetes capturados.

### Semana 3: Investigación y respuesta ante incidentes

![Cinco íconos muestran el curso seguido de las cuatro semanas secuencialmente de izquierda a derecha con la semana 3 resaltada](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/rxlJ0rYcTF6wnVgirsJ0cg_f04cc71bd1dc40b9af25033b67f790f1_el9KXjx-6uIUwUK4ehQ6OgMkTaZdiUVDQ-KVVuUtxDIBqI3gONLJks70N5QCXNVfTQJN4C7AhOsEu2VmtVmWPRsn-rP6F14Px5KY7WJ3uX17wl6DHlwJhInxkQnpQfM0PqIUt73UV8WSuImjXSD43g?expiry=1701561600000&hmac=9gvvHXdLxM_1fwf2hFfPEpXbrUw8Ygr4xyGgiqWlVGg)

Aprenderás sobre los diversos procesos y procedimientos en las etapas de detección, investigación, análisis y respuesta a incidentes. Luego, analizarás los detalles de los hashes de archivos sospechosos utilizando herramientas de investigación. También aprenderás sobre la importancia de la documentación, la recopilación de pruebas, el proceso de triaje y otros aspectos relevantes.

### Semana 4: Tráfico de red y registros mediante el uso de herramientas IDS y SIEM

![Cinco íconos muestran el curso seguido de las cuatro semanas secuencialmente de izquierda a derecha con la semana 4 resaltada](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/CLGJ8uxLQKyQPOqQHt5D4A_a4ca69c8984042a4882d918718cba6f1_5z9iTh17edDggDnMMhv3WzwleTbbhvf1oaiFKleWlwYcSpd36t_4E8q0TbBm7Gw9Tx-SpHLt5CpL-NOOVmeIYcP3x5xB1H29gwyr8J7SzMMnivOMBPT4q2YSsHTjZRb7ak10hWWx_IjcwYAZCfbAkQ?expiry=1701561600000&hmac=NfEiVoPrh1kR1YIg7F7HdSTcLIraeh0s7GECJVt7Sqc)

Explorarás los registros y su función en las herramientas de sistemas de detección de intrusiones (IDS) y de gestión de eventos e información de seguridad (SIEM). Aprenderás cómo estos sistemas colaboran para ayudar a los equipos de ciberseguridad a monitorear los sistemas y detectar actividades maliciosas. También conocerás algunos productos de IDS y SIEM, y practicarás el uso de herramientas para realizar consultas.


![[Pasted image 20231201102851.png]]

## Incident
An occurrence that actually or imminently jeopardizes, without lawful authority, the confidentiality, integrity, or availability of information or an information system; or constitutes a violation or imminent threat of violation of law, security policies, security procedures, or acceptable use policies.

## *Event*
An observable occurrence on a network, system, or device.

## *The 5 W's of an incident*
- Who triggered the incident
- What happened
- When the incident took place
- Where the incident took place
- Why the incident occurred


## *Incident handler's journal*
A form of documentation used in incident response.

![[Pasted image 20231201164927.png]]
![[Pasted image 20231201165119.png]]

## Computer security incident response teams (CSIRT)
A specialized group of security professionals that are trained in incident management and response.

## Roles in CSIRT
- Security analyst
- Technical Lead
- Incident coordinador
## Mando, control y comunicación

Un **equipo de respuesta a incidentes de seguridad informática (CSIRT, por sus siglas en inglés)** es un grupo de personas especializadas en seguridad, capacitadas en gestión y respuesta a incidentes. Durante la respuesta a incidentes, los equipos pueden enfrentar diversos desafíos. Para que la respuesta a incidentes sea efectiva y eficiente, es necesario contar con un mando claro**,** control y comunicación de la situación, a fin de lograr el objetivo deseado. 

- **El mando** se refiere a tener el liderazgo adecuado y la dirección necesaria para supervisar la respuesta.
    
- **El control** se refiere a la capacidad de gestionar los aspectos técnicos durante la respuesta a incidentes, como coordinar recursos y asignar tareas.
    
- **La comunicación** se refiere a la capacidad de mantener informadas a las partes interesadas.
    

Establecer una estructura organizativa CSIRT con funciones claras y diferenciadas ayuda a alcanzar una respuesta efectiva y eficiente.

## Roles en un CSIRT

Los equipos de respuesta a incidentes de seguridad informática (CSIRT) dependen de la organización, lo que significa que pueden variar en cuanto a su estructura y funcionamiento. Desde una perspectiva estructural, pueden existir como un equipo independiente y dedicado o como un grupo de trabajo que se reúne cuando es necesario. Los CSIRTs involucran tanto a profesionales especializados en la seguridad como a profesionales no especializados. Con frecuencia se consulta a profesionales no especializados en seguridad para que brinden su experiencia en relación con el incidente. Estos profesionales pueden provenir de departamentos externos, como recursos humanos, relaciones públicas, administración, TI, legales y otros. Los profesionales de seguridad que forman parte de un CSIRT suelen desempeñar tres funciones clave relacionadas con la seguridad: 

1. **Analista de seguridad**
    
2. **Responsable técnico**
    
3. **Coordinador de incidentes**
    

### **Analista de seguridad**

El trabajo del **analista de** **seguridad** consiste en monitorear de manera continua un entorno en busca de posibles amenazas a la seguridad. Esto incluye: 

- Analizar y clasificar las alertas.
    
- Realizar investigaciones de causa raíz.
    
- Notificar a superiores o resolver las alertas. 
    

Si se identifica una amenaza crítica, los analistas la remiten al líder correspondiente del equipo, como el responsable técnico.

### **Responsable técnico**

El trabajo del responsable técnico es gestionar todos los aspectos técnicos del proceso de respuesta a incidentes, como la aplicación de parches o actualizaciones de software. Para ello, primero determina la causa raíz del incidente. Luego, crea e implementa las estrategias para contener, erradicar y recuperarse del incidente. Los responsables técnicos suelen colaborar con otros equipos para asegurarse de que sus prioridades en la respuesta a incidentes se alineen con las prioridades del negocio, como la reducción de interrupciones para los clientes o el retorno a la normalidad de las operaciones.

### **Coordinador de incidentes**

La respuesta a un incidente también implica una colaboración interdisciplinaria con profesionales que no se especializan en seguridad. Los equipos de respuesta a incidentes de seguridad informática (CSIRT) suelen consultar y aprovechar la experiencia de miembros de departamentos externos. La persona a cargo de la coordinación de incidentes tiene la función de coordinar la tarea con los departamentos pertinentes durante un incidente de seguridad. Al hacerlo, se mantienen abiertas y claras las líneas de comunicación, y queda informado a todo el personal sobre el estado del incidente. Los coordinadores de incidentes también pueden encontrarse en otros equipos, como el Centro de Operaciones de Seguridad (SOC).

### **Otros roles**

Dependiendo de la organización, se pueden encontrar muchos otros roles en un equipo de respuesta a incidentes de seguridad informática (CSIRT), incluyendo responsables de comunicación, de legales o de planificación, entre otros. 

**Nota**: Los equipos, roles, responsabilidades y estructuras organizativas pueden variar en cada empresa. Por ejemplo, algunas funciones diferentes para la persona a cargo de la coordinación de incidentes incluyen la dirección y gerencia de incidentes.

## Centro de Operaciones de Seguridad

Un **Centro de Operaciones de Seguridad (SOC, por sus siglas en inglés)** es una unidad organizativa dedicada a monitorear redes, sistemas y dispositivos en busca de amenazas o ataques de seguridad. Estructuralmente, un SOC suele existir como unidad independiente o dentro de un CSIRT. Es posible que te hayas familiarizado con el término _equipo azul_, que se refiere a los profesionales de seguridad responsables de la defensa contra todas las amenazas y ataques a la seguridad en una organización. Un SOC participa en diversas actividades del equipo azul, como el monitoreo de redes, el análisis y la respuesta a incidentes.

## Organización de un SOC

Un Centro de Operaciones de Seguridad (SOC) está compuesto por analistas, líderes y gerentes. Cada función tiene sus propias responsabilidades. Los analistas SOC se agrupan en tres niveles diferentes.

![Un triángulo con cuatro niveles etiquetados. De abajo hacia arriba: Analista SOC L1, analista SOC L2, líder de SOC L3 y geren](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/Bh7ERqpRTZC3evJnbhUk9w_09d1972321f6419fac403795ed90cbf1_i3sZmgCOF9snWcWXSN59AeK_qYAg9DKrvt2MENqEUCr_p498QOrjAUsNyIMdKlGjBQ2CMXm9HrhguoMrSzssXRVjFuB18kPiYcHLevvFvWWBMt4e8OD-2C9CiolWsbsoUoZaeZV9VxVjph0LmL_Tlw?expiry=1701561600000&hmac=AOyGSQ9eAHg_LA8fGv1stVwZeWJIN-ouaWiT4C7he0Y)

### **Analista SOC de nivel 1**

El primer nivel está compuesto por los analistas SOC menos experimentados, conocidos como analistas de nivel 1 (L1, por level 1). Son responsables de:

- Monitorear, revisar y priorizar las alertas basándose en su criticidad o gravedad.
    
- Crear y cerrar alertas utilizando sistemas de tickets.
    
- Notificar los tickets de alerta a los niveles 2 o 3.
    

### **Analista SOC de nivel 2**

El segundo nivel está formado por los analistas SOC más experimentados, o analistas de nivel 2 (L2). Son responsables de: 

- Recibir tickets escalados de L1 y realizar investigaciones más profundas.
    
- Configurar y perfeccionar las herramientas de seguridad.
    
- Reportar al líder SOC.
    

### **Líder SOC de nivel 3**

El tercer nivel de un SOC está compuesto por los jefes SOC o líderes de nivel 3 (L3s). Estos profesionales altamente experimentados son responsables de:

- Gestionar las operaciones de su equipo.
    
- Explorar métodos de detección mediante la realización de técnicas de detección avanzadas, como el análisis forense y de malware.
    
- Reportar al gerente SOC
    

### **Gerente SOC**

El gerente SOC está en la parte superior de la pirámide y es responsable de: 

- Contratar, formar y evaluar a los miembros del equipo SOC.
    
- Crear métricas y gestionar el rendimiento del equipo SOC.
    
- Desarrollar informes relacionados con incidentes, cumplimiento normativo y auditoría.
    
- Comunicar los resultados a las partes interesadas, como la dirección ejecutiva.
    

### **Otros roles**

Los SOC también pueden contener otras funciones especializadas, como ser: 

- **Investigadores forenses**: pertenecen comúnmente a L2 y L3, y recopilan, conservan y analizan pruebas digitales relacionadas con incidentes de seguridad para determinar lo sucedido.
    
- **Cazadores de amenazas**: suelen ser L3 que trabajan para detectar, analizar y defenderse contra amenazas de ciberseguridad nuevas y avanzadas, utilizando inteligencia de amenazas.
    

**Nota**: Al igual que los CSIRT, la estructura organizativa de un SOC puede variar dependiendo de la organización.

## Conclusiones clave

Como analista de seguridad, trabajarás en colaboración con los miembros de tu equipo y con personas ajenas a él. Comprender la estructura organizativa de un equipo de respuesta a incidentes, ya sea un CSIRT o un SOC, te permitirá entender cómo los incidentes avanzan a lo largo de su ciclo de vida y las responsabilidades de los diversos roles de seguridad a lo largo de todo el proceso. Tener claridad sobre tu rol y el de otros profesionales durante un evento de respuesta a incidentes te facilitará enfrentar situaciones de seguridad desafiantes al aprovechar diferentes perspectivas y buscar soluciones creativas.

## Recursos para obtener información adicional

Aquí tienes algunos recursos si deseas obtener más información sobre la organización de un SOC o explorar otras funciones de respuesta a incidentes:

- [El ecosistema de operaciones de seguridad.](https://chronicle.security/blog/posts/soc-ecosystem-infographic/)
    
- [Herramienta de trayectorias profesionales en ciberseguridad.](https://niccs.cisa.gov/workforce-development/cyber-career-pathways-tool)
    
- [Detección y respuesta](https://www.youtube.com/watch?v=QZ0cpBocl3c) en Google: Episodio 2 de la serie de videos de [Hackeo a Google](https://www.youtube.com/playlist?list=PL590L5WQmH8dsxxz7ooJAgmijwOz0lh2H).
## Elements of a security plan
- Policies
- Standards
- Procedures

## Incident response plan
A document that outlines the procedures to take in each step of incident response.

## Elements of an incident plan
- Incident response procedures
- System information
- Other documents
![[Pasted image 20231201170637.png]]
![[Pasted image 20231201170653.png]]

## Tools types

- Detection and management tools
- Documentation tools
- Investigate tools

## Documentation
Any form of recorded content that is used for a specific purpose.


# Types of documentation
- Playbooks
- Incident handler's journals
- Policies
- Plans
- Final reports
## Playbook
A manual that provides details about any operational action.

Word  processor tools
- Google docs
- OneNote
- Evernote
- Notepad++
## Ticketing systems
- Jira
## Other tools
- Google Sheets
- Audio recorders
- Cameras
- Handwritten notes

## Intrusion detection system (IDS)
An application that  monitors system and network activity and produces alerts on posible intrusions.

## Intrusion prevention system (IPS)
An application that monitors system activity for intrusions and take action to stop the activity.

# IDS and IPS tools
- Snort
- Zeek
- Kismet
- Sagan
- Suricata
En esta lectura, compararás y contrastarás estas herramientas y aprenderás sobre la **detección y respuesta de puntos de conexión** (**EDR**). Como analista de seguridad, es probable que trabajes con estas herramientas, por lo que te será de utilidad conocer sus funciones.

## Por qué necesitas herramientas de detección

Las herramientas de detección funcionan de forma similar a los sistemas de seguridad para el hogar. Mientras que estos últimos monitorean y protegen las viviendas contra intrusiones, las herramientas de detección de ciberseguridad ayudan a las organizaciones a resguardar sus redes y sistemas contra accesos no deseados ni autorizados. Para que las organizaciones puedan proteger sus sistemas contra amenazas o ataques de seguridad, es fundamental que sean notificadas ante cualquier indicio de intrusión. Estas herramientas de detección mantienen a los profesionales de seguridad al tanto de la actividad que se desarrolla en una red o sistema. Para ello, monitorean de forma continua las redes y los sistemas en busca de cualquier actividad sospechosa. Una vez que se detecta algo inusual o sospechoso, la herramienta activa una alerta que notifica al profesional de seguridad, permitiéndole investigar y detener la posible intrusión.

## Herramientas de detección

Como analista de seguridad, es probable que en algún momento te encuentres con herramientas de detección **IDS**, **IPS** y **EDR**. Por lo tanto, es importante que conozcas las diferencias que hay entre ellas. Aquí tienes una tabla comparativa que puede servirte como referencia:

|**Capacidad**|**IDS**|**IPS**|**EDR**|
|---|---|---|---|
|Detecta actividad maliciosa|✓|✓|✓|
|Previene las intrusiones|N/A|✓|✓|
|Registra la actividad|✓|✓|✓|
|Genera alertas|✓|✓|✓|
|Realiza análisis de comportamiento|N/A|N/A|✓|

## Descripción general de las herramientas IDS

Un **sistema de detección de intrusiones** (**IDS**) es una aplicación que monitorea la actividad del sistema y emite alertas sobre posibles accesos no autorizados. Un IDS proporciona un seguimiento continuo de eventos de red para ayudar a protegerse contra amenazas o ataques de seguridad. El objetivo de un IDS es detectar actividades potencialmente maliciosas y generar una alerta. Un IDS _no_ detiene ni previene la actividad. En su lugar, los profesionales de la seguridad investigarán la alerta y actuarán para detenerla, si es necesario. 

Por ejemplo, un IDS puede enviar una alerta cuando identifica un inicio de sesión de usuario sospechoso, como una dirección IP desconocida que inicia sesión en una aplicación o un dispositivo a una hora inusual. Sin embargo, un IDS no detendrá ni impedirá acciones adicionales, como bloquear el inicio de sesión del usuario sospechoso. 

Algunos ejemplos de herramientas de IDS incluyen Zeek, Suricata, Snort® y Sagan.

### **Categorías de detección**

Como analista de seguridad, investigarás las alertas que genera un IDS. Existen cuatro tipos de categorías de detección que deberías conocer:

1. **Un verdadero positivo** es el resultado de un análisis o una detección en el que un sistema de seguridad identifica correctamente un incidente real.
    
2. **Un verdadero negativo** es el resultado de un análisis o una detección en el que un sistema de seguridad identifica correctamente la inexistencia de incidentes. Esto ocurre cuando no existe actividad maliciosa y no se dispara ninguna alerta. 
    
3. **Un falso positivo** es el resultado de un análisis que detecta erróneamente una amenaza y dispara una alerta. Esto ocurre cuando un IDS identifica una actividad como maliciosa, pero no lo es. Los falsos positivos son una molestia para los equipos de seguridad, porque pierden tiempo y recursos investigando una alerta ilegítima. 
    
4. **Un falso negativo** es el resultado de un análisis que no detecta una amenaza existente y, por lo tanto, no activa una alerta. Esto ocurre cuando sucede una actividad maliciosa pero un IDS no la detecta. Los falsos negativos son peligrosos porque dejan a los equipos de seguridad sin saber de ataques legítimos a los que pueden ser vulnerables.
    

## Descripción general de las herramientas IPS

Un **sistema de prevención de intrusiones** (**IPS**) es una aplicación que monitorea la actividad del sistema en busca de actividades intrusivas y toma medidas para detenerlas. Un IPS funciona de manera similar a un IDS. Sin embargo, el IPS monitorea la actividad del sistema para detectar y alertar sobre intrusiones, _y_ también toma medidas para _prevenir_ la actividad y minimizar sus efectos. Por ejemplo, un IPS puede enviar una alerta y modificar una lista de control de acceso en un router, para bloquear tráfico específico en un servidor.

**Nota:** Muchas herramientas IDS también pueden funcionar como IPS. Herramientas como Suricata, Snort y Sagan tienen capacidades tanto de IDS como de IPS.

## Descripción general de las herramientas EDR

La **detección y respuesta de puntos de conexión** (**EDR**) es una aplicación que monitorea la actividad maliciosa en un punto de conexión. Las herramientas de EDR se instalan en los **puntos de conexión,** es decir, cualquier dispositivo conectado a una red. Algunos ejemplos incluyen los dispositivos de usuario final, como computadoras, teléfonos y tabletas, entre otros.

Las herramientas EDR monitorean, registran y analizan la actividad del sistema del punto de conexión para identificar, alertar y responder a actividades sospechosas. A diferencia de las herramientas de IDS o IPS, las de EDR recopilan datos de actividad del punto de conexión y realizan _análisis de comportamiento_ para identificar patrones de amenazas. El análisis de comportamiento utiliza la potencia del aprendizaje automático y la inteligencia artificial para analizar el comportamiento del sistema e identificar actividades maliciosas o inusuales. Las herramientas de EDR también utilizan la _automatización_ para detener los ataques sin la intervención manual de los profesionales de seguridad. Por ejemplo, si una herramienta de EDR detecta un proceso inusual que se inicia en la estación de trabajo de un usuario y que normalmente no se utiliza, puede bloquear automáticamente la ejecución del proceso.

Open EDR®, Bitdefender™ Endpoint Detection and Response y FortiEDR™ son ejemplos de herramientas de EDR.

**Nota**: La gestión de eventos e información de seguridad (SIEM) también tiene capacidades de detección, que verás más adelante.

## Security Information and Event Management (SIEM)
An application that collects and analyzes log data to monitor critical activities in an organization.

## SIEM process
1. Collect and aggregate data
2. Normalize data
3. Analyze data
## Security orchestration, automation, and response (SOAR)
A collect of applications, tools, and workflows that uses automation to respond to security events.


Primero, las SIEM recopilan y agregan datos. Estos datos suelen estar en forma de registros, que son básicamente un registro de todos los eventos que ocurrieron en una fuente dada. Los datos pueden provenir de múltiples fuentes como IDS o IPS, bases de datos, firewalls, aplicaciones y más. Después de recopilar todos estos datos, se agregan. Esto significa que todos estos datos de diferentes fuentes se centralizan en un solo lugar. 
Según el número de fuentes de datos de las que recopila un SIEM, se pueden recolectar un gran volumen de información sin editar. Y no todos los datos que recopila una SIEM son relevantes para el análisis de seguridad. 
Las herramientas SIEM normalizan los datos. La normalización toma los datos brutos que la SIEM recolectó y los limpia al eliminar atributos no esenciales, por lo que solo se incluye lo relevante. La normalización también crea consistencia en los registros, lo que es útil cuando buscas información específica durante la investigación de incidentes. 
Por último, los datos normalizados se analizan según reglas configuradas. SIEM analiza los datos normalizados según un conjunto de reglas para detectar incidentes de seguridad, que luego se categorizan o reportan como alertas para que los analistas las revisen.

## Network traffic
The amount of data that moves across a network.

## *Indicators of compromise (IOC)*
Observable evidence that suggests signs of a potential security incident.

## *Data exfiltration*
Unauthorized transmission of data from a system.


## Protege tu red

En este programa, aprendiste sobre los **centros de operaciones de seguridad** (**SOC**) y su papel en el monitoreo de sistemas contra amenazas y ataques de seguridad. Las organizaciones pueden implementar un **centro de operaciones de red** (**NOC**), que es una unidad organizativa encargada de supervisar el rendimiento de una red y responder a cualquier interrupción, como un fallo de red. Mientras que un SOC se centra en mantener la seguridad de una organización a través de la detección y la respuesta, un NOC es responsable de mantener el rendimiento, la disponibilidad y el tiempo de actividad de la red.

![Una analista monitorea la actividad del sistema en múltiples pantallas de computadora.](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/154AARwzRqyJhEtqFRc2sA_e79a76cc23ba461993ff6fb793b6def1_nkISYJEQXEeyI_EULYzu1n3wPmID7_oy12ib7AQ55Z885Xsj5fiET-OY-NNxEeVJz-d2WgpW5lmpGGS6M5Mxp2BJ36Spb54onxc86Z-LLRhlu16cdueXvxByPXhAPOkOrtz5RPHChcMbhCRo7yWZjg?expiry=1701648000000&hmac=XvgP5fbGPPsVirCmNxjKV02ZZ5k0OH91nUoygz5nnrs)

Los analistas de seguridad monitorean las redes para identificar cualquier signo de posibles incidentes de seguridad, conocidos como **indicadores de compromiso** (**IoC**), y protegerlas contra los ataques o amenazas. Para hacerlo, deben comprender el entorno por el que viajan las comunicaciones de red y así poder identificar las desviaciones en el tráfico de red.

### **Herramientas de monitoreo de red**

El monitoreo de la red se puede automatizar o realizar de forma manual. Algunas herramientas comúnmente utilizadas pueden incluir: 

- **Sistemas de detección de intrusiones** (**IDS**), que monitorean la actividad del sistema y alertan sobre posibles intrusiones. Un IDS identifica y alerta sobre las desviaciones que le hayas configurado para que detecte. Lo más habitual es que las herramientas IDS monitoreen el contenido de la carga útil del paquete para detectar los patrones asociados con amenazas como malware o intentos de phishing.
    
- **Analizadores de protocolo de red**, también conocidos como rastreadores de paquetes, que son herramientas diseñadas para capturar y analizar el tráfico de datos dentro de una red. Se pueden utilizar para analizar las comunicaciones de red manualmente en detalle. Los ejemplos incluyen herramientas como tcpdump y Wireshark, que pueden utilizar los profesionales de seguridad para registrar comunicaciones de red a través de capturas de paquetes. Estas se pueden investigar para identificar las actividades potencialmente maliciosas.
    

## Conclusiones clave

Monitorear y proteger las redes de intrusiones y ataques son responsabilidades fundamentales de los profesionales de seguridad. No se puede proteger lo que no se conoce. Como analista de seguridad, necesitarás comprender los componentes de una red y las comunicaciones que ocurren en ella, para así poder protegerla de manera más efectiva. Los valores de referencia proporcionan una forma de comprender el tráfico de red al revelar patrones comunes que ayudan a identificar cualquier desviación de los patrones de tráfico esperados. Herramientas como los sistemas de detección de intrusiones y los analizadores de protocolos de red apoyan los esfuerzos para monitorear las actividades de la red.

## Recursos

- Si deseas obtener más información sobre los componentes de red que las organizaciones pueden monitorear, consulta [tráfico de red: MITRE ATT&CK®](https://attack.mitre.org/datasources/DS0029/)
    
- Los atacantes pueden aprovechar diferentes técnicas para exfiltrar datos. Si deseas obtener más información, consulta [técnicas de exfiltración de datos: MITRE ATT&CK®](https://attack.mitre.org/tactics/TA0010/)

### Defensive measures
1. Prevent attacker access.
2. Monitor network activity.
3. Protect assets.
4. Detect and stop the exfiltration.

![[Pasted image 20231202125142.png]]

## Components of packet
1. Header
2. Payload
3. Footer

## Network protocol analyzer (packet sniffer)
A tool designed to capture and analyze data traffic within a network.

## Packet capture (P-cap)
A file containing data packets intercepted from an interface or network.


### **Encabezado**

Los paquetes comienzan con el componente fundamental: el encabezado. Estos pueden tener varios encabezados según los protocolos utilizados, como un encabezado Ethernet, uno de IP o uno de TCP, entre otros. Los mismos proporcionan información que se utiliza para enrutar los paquetes a su destino. Esto incluye información sobre las direcciones IP de origen y destino, la longitud del paquete, el protocolo, los números de identificación y más.

He aquí un encabezado IPv4 con la información que proporciona:

![Un encabezado IPv4 con sus 13 campos](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/6gjaSQ2dT9e7vYYiKTSifQ_669df3fe66244ed995db927c2df130f1_Mi_kryGkRiyYUOJDIwnPCw_ac942d1eec284467a5ca533cb99c4bf1_S20G003.png?expiry=1701648000000&hmac=lMSOhNIUeCj5qppxwk9y4HlDcWSvJcAddHsgPG0OQLA)

### **Carga útil**

El componente de carga útil viene directamente después del encabezado y contiene los datos reales que se entregan. Si consideras el ejemplo de cargar una fotografía en un sitio web, la carga útil de este paquete sería la imagen en sí.

### **Pie**

El pie, también conocido como el avance, se encuentra al final de un paquete. El protocolo Ethernet utiliza pies para brindar información de verificación de errores y determinar si los datos se dañaron. Además, puede que los paquetes de red Ethernet analizados no muestren información de pie debido a las configuraciones de red.

**Nota:** La mayoría de los protocolos, como el Protocolo de Internet (IP), _no_ utilizan pies.

## Analizadores de protocolo de red

**Los analizadores de protocolo de red,** **o rastreadores de paquetes,** son herramientas diseñadas para capturar y analizar el tráfico de datos dentro de una red. Algunos ejemplos son tcpdump, Wireshark y TShark. 

Más allá de su uso en seguridad como una herramienta de investigación que monitorea redes e identifica actividades sospechosas, los analizadores de protocolo de red pueden utilizarse para recopilar estadísticas de redes, como el ancho de banda o la velocidad de conexión, y solucionar problemas de rendimiento, como las ralentizaciones. 

No obstante, también se pueden utilizar con fines maliciosos. Por ejemplo, los agentes de amenaza pueden usar analizadores de protocolo de red para capturar paquetes que contienen datos confidenciales, como la información de inicio de sesión de la cuenta.

Aquí hay un diagrama de red que ilustra la transmisión de los paquetes de un emisor al receptor. Un analizador de protocolos de red se coloca en el medio de las comunicaciones para capturar los paquetes de datos que viajan a través del cable.

![La computadora A envía paquetes de datos a la computadora B. El analizador de protocolos de red se encuentra en el medio de l](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/S5m0blFXQXOCvuuLm9SDPw_d556e01971824284af4c305b18b21af1_oFszp6dK-zlE_V1vC7IoR8bNWi0Lgbf0LuA2TI5C45EsSQUgxgJe_H8sDWcAqIM8X4JaX07v69vC8CgCT8q26xgD2T8g98TaCeO1-RRjRBMNoMp3dWR2rF8_oV4pnqdk5JAYPhVNYp0AvY9bSGmrNg?expiry=1701648000000&hmac=ofYuqD-EoJGNHNEdele9T6oPaTV-Q8Sznw4598vEkK0)

### **Cómo funcionan los analizadores de protocolo de red**

Estos analizadores utilizan capacidades de software y hardware para capturar el tráfico de red y mostrarlo para que los analistas de seguridad lo examinen y analicen. A continuación, te contamos cómo lo hacen:

1. Primero, los paquetes deben recopilarse de la red a través de la **tarjeta de interfaz de red (NIC)**, que es el hardware que conecta las computadoras a una red, como un router. Las NIC reciben y transmiten tráfico de red, pero por defecto solo consideran el tráfico de red que está dirigido a ellas. Para capturar todo el tráfico que se envía a través de la red, una NIC debe ser cambiada a un modo que tenga acceso a todos los paquetes de datos de red visibles. En las interfaces inalámbricas, esto se conoce con frecuencia como modo de monitoreo, y en otros sistemas se puede llamar modo promiscuo. Este modo permite que la NIC acceda a todos los paquetes de datos de red visibles, pero no ayudará a los analistas a acceder a todos los paquetes a través de una red. Un analizador de protocolos de red debe posicionarse en un segmento de red apropiado para acceder a todo el tráfico entre diferentes hosts.
    
2. El analizador de protocolos de red recopila el tráfico de red en formato binario sin procesar. El formato binario consta de ceros y unos, y las personas no pueden interpretarlo con facilidad. El analizador de protocolos de red toma el formato binario y lo convierte para que se muestre en un modo legible para las personas, de modo que los analistas puedan leer y comprender la información con facilidad.
    

### **Cómo capturar paquetes**

El **rastreo de paquetes** es la práctica de capturar e inspeccionar paquetes de datos a través de una red. Un archivo **pcap (captura de paquetes )** es un archivo que contiene paquetes de datos interceptados desde una interfaz o red. Estas capturas se pueden ver y analizar adicionalmente mediante analizadores de protocolo de red. Por ejemplo, puedes filtrar las capturas de paquetes para mostrar solo la información más relevante para tu investigación, como los paquetes enviados desde una dirección IP específica.

**Nota**: En muchos lugares, se considera ilegal utilizar analizadores de protocolo de red para interceptar y examinar las comunicaciones de red privada sin permiso.

Los archivos pcap pueden venir en diversos formatos según la biblioteca de captura de paquetes que se utilice. Cada uno tiene diferentes usos y las herramientas de red pueden utilizar o admitir formatos de archivo de captura de paquetes específicos de forma predeterminada. Te recomendamos familiarizarte con las siguientes bibliotecas y formatos:

1. **Libpcap** es una biblioteca de captura de paquetes diseñada para que la utilicen sistemas similares a Unix, como Linux y MacOS®. Las herramientas como tcpdump utilizan Libpcap como formato predeterminado de archivo de captura de paquetes. 
    
2. **WinPcap** es una biblioteca de captura de paquetes de código abierto diseñada para dispositivos que ejecutan sistemas operativos Windows. Se considera un formato de archivo más antiguo y no se usa principalmente.
    
3. **Npcap** es una biblioteca diseñada por la herramienta de escaneo de puertos Nmap que se utiliza comúnmente en los sistemas operativos Windows.
    
4. **PCAPng** es un formato de archivo moderno que puede capturar paquetes y almacenar datos en simultáneo. Su capacidad para hacer ambas cosas explica el “ng”, que significa “próxima generación”.
    

**Consejo profesional:** Analizar tu red doméstica puede ser una buena manera de poner en práctica el uso de estas herramientas.

### **IPv4**

IPv4 es la versión más utilizada de IP. En el encabezado hay 13 campos:

- **Versión**: Indica la versión de IP. Para un encabezado IPv4, se utiliza IPv4. 
    
- **Longitud del encabezado de Internet (IHL)**: Especifica la longitud del encabezado IPv4, incluidas las opciones.
    
- **Tipo de servicio (ToS)**: Proporciona información sobre la prioridad del paquete para la entrega.
    
- **Longitud total**: Especifica la longitud total de todo el paquete IP, incluidos el encabezado y los datos.
    
- **Identificación**: Especifica un identificador único para fragmentos de un paquete IP original para que puedan volver a ensamblarse una vez que lleguen a su destino. Esto es así porque los paquetes que son demasiado grandes para enviar se fragmentan en piezas más pequeñas. 
    
- **Indicadores**: Proporciona información sobre la fragmentación de paquetes, incluso si se fragmentó el paquete original y si hay más fragmentos en tránsito.
    
- **Desplazamiento de fragmentos**: Se utiliza para identificar la secuencia correcta de los fragmentos.
    
- **Tiempo de vida (TTL)**: Limita el tiempo que un paquete puede circular en una red, lo que evita que los routers envíen los paquetes de forma indefinida.
    
- **Protocolo**: Especifica el protocolo utilizado para el área de datos del paquete.
    
- **Suma de comprobación de cabecera**: Especifica un valor de suma de comprobación que se utiliza para comprobar el error del encabezado.
    
- **Dirección de origen**: Especifica la dirección de origen del emisor.
    
- **Dirección de destino**: Especifica la dirección de destino del receptor.
    
- **Opciones**: Es opcional y se puede utilizar para aplicar opciones de seguridad a un paquete.
    

![Un encabezado IPv4 con sus 13 campos.](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/Ywq1ri9mSOW41rrads3D-Q_bf06a435ac5f4275a0f545ec9f40c6f1_44s2Ico1T8kYxk8TS5zRssEwAEptKg9URY4GghpOGFsH0zMYjD0RPDfWYSiCTpIW26rLOdBEpDoO6mgTluoV8DW12AoSe2w8LdxQTmlpJ1K8XFU_NkcY-VPKwmg7xEnsL-3uqJ7tatCTXKbyXwWOw?expiry=1701734400000&hmac=Dv5V7g-xUDEVgHOYhlailLOzDpWAzWhsdgO0bQOLlYU)

### **IPv6**

Gracias a su gran espacio de direcciones, la adopción de IPv6 ha ido en aumento. Su encabezado cuenta con ocho campos:

- **Versión**: Indica la versión de IP. Para un encabezado IPv6, se utiliza IPv6.
    
- **Clase de tráfico**: Similar al campo Tipo de servicio IPv4, proporciona información sobre la prioridad o clase del paquete para ayudar con la entrega.
    
- **Etiqueta de flujo**: Identifica los paquetes de un flujo. Un flujo es la secuencia de paquetes enviados desde una fuente específica. 
    
- **Longitud de carga útil**: Especifica la longitud del área de datos del paquete.
    
- **Encabezado siguiente**: Indica el tipo de encabezado que sigue al encabezado IPv6, como TCP.
    
- **Límite de salto**: Similar al campo Tiempo de vida de IPv4, restringe el tiempo que un paquete puede viajar en una red antes de que se descarte.
    
- **Dirección de origen**: Especifica la dirección de origen del emisor.
    
- **Dirección de destino**: Especifica la dirección de destino del receptor.
    

![Un encabezado IPv6 con sus 8 campos.](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/8kh4c6x_SLSj_pAcr1M0Ig_26501bdbe1d240fc9f88862f46503af1_HhcRPpmgaJtBDlPHP_bdpBbFVkhL6CJIYhR3ONQoXh62tkHtCrXoRjhqIMQ85WWnYwHsUmsLAE2uuYedK9lSgcI4Cozpr7lwHeJ9YOGJQZa6Qplk19Vd0RtzvYEREfVoSsZoivfAzWYkLM0FPeFUzQ?expiry=1701734400000&hmac=Z80JSSxXZ-91SM_XozICqu5jlRjdTlOwrZcAzy2Mwk8)

Los campos de encabezado contienen información valiosa para investigaciones y herramientas como Wireshark que ayudan a mostrarlos en un formato legible para las personas.

## Wireshark

**Wireshark** es un analizador de protocolos de red de código abierto. Utiliza una interfaz gráfica de usuario (GUI), lo que facilita la visualización de las comunicaciones de red con fines de análisis de paquetes. Wireshark tiene muchas características para explorar que no se alcanzan a cubrir en este curso. Te enfocarás en cómo usar el filtrado básico para aislar los paquetes de red de modo que puedas encontrar lo que necesitas.

![Interfaz de Wireshark.](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/yLoca_o8RSKOwYSJK4bB5Q_f2021dc9bbdd427fa1ecc686ff2ebff1_SrU-DA-pR1eTtgJe4lBOjQ_c841a1d648aa40069fe7e47e84ea79f1_CS_R-125_Wireshark-homepage.png?expiry=1701734400000&hmac=GCDYn760bxbvS8jIGvfOzhldjw-dtzNKnOehDi6xlXU)

### Filtros de visualización

Los filtros de visualización de Wireshark te permiten aplicar filtros a  archivos de captura de paquetes. Esto es útil cuando estás inspeccionando capturas de paquetes con grandes volúmenes de información. Los filtros de visualización te ayudarán a encontrar información específica que sea relevante para tu investigación. Puedes filtrar paquetes en función de información como protocolos, direcciones IP, puertos y cualquier otra propiedad encontrada en un paquete. Aquí te centrarás en la sintaxis de filtrado de visualización y en el filtrado de protocolos, direcciones IP y puertos.

### Operadores de comparación

Puedes utilizar diferentes operadores de comparación para localizar campos y valores específicos en los encabezados. Los operadores de comparación pueden expresarse utilizando abreviaturas o símbolos. Por ejemplo, este filtro que utiliza el símbolo igual == en este filtro ip.src == 8.8.8.8 es idéntico al uso de la abreviatura eq en este filtro ip.src eq 8.8.8.8.

Esta tabla resume los diferentes tipos de operadores de comparación que puedes utilizar para el filtrado de visualización.

|**Tipo de operador**|**Símbolo**|**Abreviatura**|
|Igual|==|eq|
|No es igual|!=|ne|
|Mayor que|>|gt|
|Menor que|<|lt|
|Mayor que o igual a|>=|ge|
|Menor que o igual a|<=|le|

**Consejo profesional:** Puedes combinar operadores de comparación con operadores lógicos booleanos como and (y) y or (o) para crear filtros de visualización complejos. Los paréntesis también se pueden utilizar para agrupar expresiones y priorizar términos de búsqueda.

### Operador contains

El operador contains se utiliza para filtrar paquetes que contienen una coincidencia exacta de una cadena de texto. Aquí, podrás ver un ejemplo de un filtro que muestra todos los flujos HTTP que coinciden con la palabra clave "moved" (movido).

![Una captura de paquetes de Wireshark mediante el operador contains para encontrar flujos HTTP con la cadena "moved."](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/_mEOcXU1SF-TDZ2UW3-GGw_148390ed5ecc4be49f2976119fc0aaf1_XeHUkXLUeO9IYW6j279Sd0ivhBxb4UOYTt-8uf584QM_-FpeffACLKXAqPXmIRL8yY-HUkNr2les68okqGK3txqcoQfWPwKBGppLARi57HSoEULi5QVBntOgqibNU6whjJvkb35_636VxRUvQZsQ-Q?expiry=1701734400000&hmac=leNiUvjj6vQ4AoXt5N65oN-WK2Z4daOMOG1RthqaChg)

### Operador matches

El operador matches se utiliza para filtrar paquetes basados en la expresión regular (regex) que se especifica. La expresión regular es una secuencia de caracteres que forma un patrón. Más adelante en este programa, explorarás más sobre las expresiones regulares.

## Barra de herramientas de filtrado

Puedes aplicar filtros a una captura de paquetes mediante la barra de herramientas de filtrado de Wireshark. En este ejemplo, dns es el filtro aplicado, lo que significa que Wireshark solo mostrará paquetes que contengan el protocolo DNS.

![Una barra de herramientas de filtrado de Wireshark con un filtro dns aplicado.](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/DAErOPFfQgGZiGKvHgG9ng_9926a497a1a647e89e57dd04fb1c50f1_mt7DMvq-ENa0sRjBFXk2kG35IxOyln-oRMvwG6my_Lz3ytJ6Rleub3Gl59EFAaxLDSzVebeSYYmmn3H7GxTvFUF6sX3kcUxjQCeROvvGrz-_RsDcyWMZ_B7bgGzNEPfy2_p5E3EeBcsoTMZW8CDLYg?expiry=1701734400000&hmac=atp75hULiRTGnvX5FP7FphgsJmP-HUZyviQRncgR_II)

**Consejo profesional**: Wireshark utiliza diferentes colores para representar los protocolos. Puedes personalizar los colores y crear tus propios filtros.

### **Filtrar por protocolos**

El filtrado de protocolos es una de las formas más simples de utilizar los filtros de visualización. Basta solo con ingresar el nombre del protocolo para filtrar. Por ejemplo, para filtrar paquetes DNS, escribe dns en la barra de herramientas de filtrado. A continuación, podrás ver una lista de algunos protocolos que puedes filtrar:

- dns
    
- http
    
- ftp
    
- ssh
    
- arp
    
- telnet
    
- icmp
    

### **Filtrar una dirección IP**

Puedes utilizar filtros de visualización para localizar paquetes con una dirección IP específica. 

Por ejemplo, si deseas filtrar paquetes que contienen una dirección IP específica, utiliza ip.addr, seguido de un espacio, el operador de comparación == igual y la dirección IP. A continuación se muestra un ejemplo de un filtro de visualización que filtra la dirección IP 172.21.224.2:

ip.addr == 172.21.224.2

Para filtrar paquetes que se originan desde una dirección IP de origen específica, puedes usar el filtro ip.src. Aquí, puedes ver un ejemplo que busca la dirección IP de origen 10.10.10.10:

ip.src == 10.10.10.10

Para filtrar los paquetes entregados a una dirección IP de destino específica, puedes utilizar el filtro ip.dst. Aquí, puedes ver un ejemplo que busca la dirección IP de destino 4.4.4.4:

ip.dst == 4.4.4.4

### **Filtrar una dirección MAC**

También puedes filtrar paquetes según la **dirección de control de acceso al medio (MAC)**. Como actualización, una dirección MAC es un identificador alfanumérico único que se asigna a cada dispositivo físico en una red.

A continuación, se muestra un ejemplo:

eth.addr == 00:70:f4:23:18:c4

### **Filtrar por puertos**

El filtrado de puertos se utiliza para filtrar paquetes en función de los números de puerto. Esto es útil cuando quieres aislar tipos específicos de tráfico. El tráfico DNS utiliza el puerto TCP o UDP 53, por lo que esto enumerará el tráfico relacionado con las consultas y respuestas de DNS únicamente.

Por ejemplo, si quieres filtrar un puerto UDP:

udp.port == 53

Del mismo modo, también puedes filtrar puertos TCP:

tcp.port == 25

## Seguir flujos

Wireshark ofrece una función que permite filtrar paquetes específicos para un protocolo y ver flujos. Un flujo o conversación es el intercambio de datos entre dispositivos que utilizan un protocolo. Wireshark vuelve a ensamblar los datos que se transfirieron en el flujo en un formato legible.

![A través de un cuadro de diálogo de secuencia de seguimiento de Wireshark se muestra el contenido de la secuencia de una conv](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/fUbd7z6_Q-GCi_7-r5zm1A_f7a54adf72de426fbfaaaf680c05dcf1_KgYTCv_6nyI9mKUvZyskqCAMt4A6S-5IF7JmA6YhPrqlm3Fyi-Alew3CW3O8LBER-xxGK1pYE6Sm89T76-F878CCL9tljoiFAymU2bGHWFb5RE0hQjuI25jXvQv_4FU98vEjxjwjBpKAWNYf_PnpBA?expiry=1701734400000&hmac=Nj2GTukhXkaKE43oPUtAGQFFoQIGG82hbcEF56h5lCI)

Seguir un flujo de protocolo es útil cuando se trata de comprender los detalles de una conversación. Por ejemplo, puedes examinar los detalles de una conversación HTTP para ver el contenido de los mensajes intercambiados de solicitud y respuesta.

## Conclusiones clave

En esta lectura, exploraste los filtros de visualización básicos con Wireshark. El análisis de paquetes es una habilidad fundamental que seguirás desarrollando con el tiempo en tu recorrido por el mundo de la ciberseguridad. Pon en práctica tus habilidades en la próxima actividad y explora los detalles de un archivo de captura de paquetes utilizando Wireshark.

## Recursos

- Para obtener más información sobre las características y capacidades completas de Wireshark, revisa la [guía oficial del usuario de Wireshark](https://www.wireshark.org/docs/wsug_html/).
![[Pasted image 20231202203036.png]]

![[Pasted image 20231202203821.png]]
![[Pasted image 20231202203923.png]]![[Pasted image 20231202204228.png]]
![[Pasted image 20231202204530.png]]
![[Pasted image 20231202204759.png]]
![[Pasted image 20231202205132.png]]
![[Pasted image 20231202205251.png]]
![[Pasted image 20231202205500.png]]